<%#
OVERVIEW
This partial separates by IaaS the config documentation for the **Database Locations** field
in the Ops Manager **Director Config** pane.

PARTIAL REFERENCES
This partial is called from `_director-config.html.md.erb`.
`_director-config.html.md.erb` is called in all IaaS-specific BOSH Director configuration topics. %>

<%# For GCP Terraform config topic only: %>
<% if current_page.data.iaas == "GCP" and current_page.data.install_type == "terraform" %>
For **Database Location**, if you configured your `terraform.tfvars` file to create an external database for <%= vars.ops_manager %>, select **External MySQL Database** and complete the fields below. Otherwise, select **Internal**.
<p class='note'><strong>Note:</strong> The external MySQL database only applies to the BOSH Director. UAA and CredHub does not use these settings and continues to use the Postgres database colocated with the BOSH Director.</p>
<p class='note warning'><strong>Warning:</strong> After you deploy the BOSH Director, you cannot change the <b>Database Location</b> from an <b>External MySQL Database</b> to an <b>Internal</b> database or from an <b>Internal</b> database to an <b>External MySQL Database</b>.</p>
    * **Host**: Enter the value of `sql_db_ip` from your Terraform output.
    * **Port**: Enter `3306`.
    * **Username**: Enter the value of `opsman_sql_username` from your Terraform output.
    * **Password**: Enter the value of `opsman_sql_password` from your Terraform output.
    * **Database**: Enter the value of `opsman_sql_db_name` from your Terraform output.<br>
In addition, if you selected **External MySQL Database**, you can fill out the following optional fields:
    * **Enable TLS:** Selecting this checkbox enables TLS communication between the BOSH Director and the database.
    * **TLS CA:** Enter the Certificate Authority for the TLS Certificate.
    * **TLS Certificate:** Enter the client certificate for mutual TLS connections to the database.
    * **TLS Private Key:** Enter the client private key for mutual TLS connections to the database.
    <p class='note'><strong>Note:</strong> You must select <strong>Enable TLS for Director Database</strong> to configure the TLS-related fields.</p>
    * **Advanced DB Connection Options:** This field accepts a JSON-formatted options string. It should be left blank unless directed by <%= vars.company_name %> Support.
<% end %>

<%# For GCP Manual config topic only: %>
<% if current_page.data.iaas == "GCP" %>
For **Database Location**, if you configured an external MySQL database such as Cloud SQL, select **External MySQL Database** and complete the fields below. Otherwise, select **Internal**. For more information about creating a Cloud SQL instance, see [Quickstart for Cloud SQL for MySQL](https://cloud.google.com/sql/docs/mysql/quickstart) in the Google Cloud documentation.
<p class='note'><strong>Note:</strong> Use of an External MySQL Database only applies to the BOSH Director. UAA and CredHub will not use these settings and will continue to use the Postgres database colocated with the BOSH Director.</p>
<p class='note warning'><strong>Warning:</strong> After you deploy the BOSH Director, you cannot change the <b>Database Location</b> from an <b>External MySQL Database</b> to an <b>Internal</b> database or from an <b>Internal</b> database to an <b>External MySQL Database</b>.</p>
    * **Host:** Enter the value of your host.
    * **Port:** Enter your port number. For example, `3306`.
    * **Username:** Enter your username.
    * **Password:** Enter your password.
    * **Database:** Enter your database name.<br>
In addition, if you selected the **Enable TLS for Director Database** checkbox, you can fill out the following optional fields:
    * **Enable TLS:** Selecting this checkbox enables TLS communication between the BOSH Director and the database.
    * **TLS CA:** Enter the Certificate Authority for the TLS Certificate.
    * **TLS Certificate:** Enter the client certificate for mutual TLS connections to the database.
    * **TLS Private Key:** Enter the client private key for mutual TLS connections to the database.
    * **Advanced DB Connection Options:** This field accepts a JSON-formatted options string. It should be left blank unless directed by <%= vars.company_name %> Support.
<% end %>

<%# For AWS Terraform config topic only: %>
<% if current_page.data.iaas == "AWS" and current_page.data.install_type == "terraform" %>
For **Database Location**, if you choose to configure an external MySQL database with Amazon Relational Database Service (RDS) or another service, select **External MySQL Database** and complete the fields below. Otherwise, select **Internal**. For more information about creating a RDS MySQL instance, see [Creating a MySQL DB Instance](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_GettingStarted.CreatingConnecting.MySQL.html#CHAP_GettingStarted.Creating.MySQL) in the AWS documentation.
<p class='note'><strong>Note:</strong> Use of an External MySQL Database only applies to the BOSH Director. UAA and CredHub will not use these settings and will continue to use the Postgres database colocated with the BOSH Director.</p>
<p class='note warning'><strong>Warning:</strong> After you deploy the BOSH Director, you cannot change the <b>Database Location</b> from an <b>External MySQL Database</b> to an <b>Internal</b> database or from an <b>Internal</b> database to an <b>External MySQL Database</b>.</p>
    * **Host**: Enter the value of your host.
    * **Port**: Enter your port number. For example, `3306`.
    * **Username**: Enter your username.
    * **Password**: Enter your password.
    * **Database**: Enter your database name.<br>
In addition, if you selected the **Enable TLS for Director Database** checkbox, you can fill out the following optional fields:
    * **Enable TLS:** Selecting this checkbox enables TLS communication between the BOSH Director and the database.
    * **TLS CA:** Enter the Certificate Authority for the TLS Certificate.
    * **TLS Certificate:** Enter the client certificate for mutual TLS connections to the database.
    * **TLS Private Key:** Enter the client private key for mutual TLS connections to the database.
    * **Advanced DB Connection Options:** This field accepts a JSON-formatted options string. It should be left blank unless directed by <%= vars.company_name %> Support.
<% end %>

<%# For AWS Manual config topic only: %>
<% if current_page.data.iaas == "AWS" %>
For **Database Location**, select **External MySQL Database** and complete the following steps:
    <p class='note'><strong>Note:</strong> Use of an External MySQL Database only applies to the BOSH Director. UAA and CredHub will not use these settings and will continue to use the Postgres database colocated with the BOSH Director.</p>
    <p class='note warning'><strong>Warning:</strong> After you deploy the BOSH Director, you cannot change the <b>Database Location</b> from an <b>External MySQL Database</b> to an <b>Internal</b> database or from an <b>Internal</b> database to an <b>External MySQL Database</b>.</p>
    <%= image_tag("../common/images/director_database.png", :alt=> "At the top of the image are the words 'Database Location', underneath which are two options: one selected radio button labeled 'Internal', and one radio button labeled 'External MySQL Database'. Below these are five text fields labeled, from top to bottom, 'Host', 'Port', 'Username', 'Password', and 'Database'. All have red asterisks, to denote that they are required fields when 'External MySQL Database' is selected.") %>
    * From the AWS Console, navigate to the RDS Dashboard.
    * Click **Databases**, then click the instance to display the **Connectivity &amp; security** information.
    * Refer to the following table to retrieve the values for the **Director Config** page:
    <table border="1" class="nice" >
      <tr>
        <th><strong>RDS Instance Field </strong></th>
        <th><strong>BOSH Director Field </strong></th>
      </tr>
      <tr>
        <td>Endpoint</td>
        <td><strong>Host</strong></td>
      </tr>
      <tr>
        <td>Port</td>
        <td><strong>Port</strong>, which is <code>3306</code>.</td>
      </tr>
    </table><br />
    * For **Username**, enter the username that you defined for your MySQL database when you created in the [Create a MySQL Database using AWS RDS](deploy-manual.html#pcfaws-mysql-rds) in _Deploying
    * For **Password**, enter the password that you defined for your MySQL database when you created in the [Create a MySQL Database using AWS RDS](deploy-manual.html#pcfaws-mysql-rds) in _Deploying <%= vars.ops_manager %> on AWS_.
    * For **Database**, enter `bosh`.
  In addition, if you selected the **Enable TLS for Director Database** checkbox, you can fill out the following optional fields:
    * **Enable TLS:** Selecting this checkbox enables TLS communication between the BOSH Director and the database.
    * **TLS CA:** Enter the Certificate Authority for the TLS Certificate.
    * **TLS Certificate:** Enter the client certificate for mutual TLS connections to the database.
    * **TLS Private Key:** Enter the client private key for mutual TLS connections to the database.
    * **Advanced DB Connection Options:** This field accepts a JSON-formatted options string. It should be left blank unless directed by <%= vars.company_name %> Support.
<% end %>

<%# For Azure Terraform topic only: %>
<% if current_page.data.iaas == "Azure" and current_page.data.install_type == "terraform" %>
For **Database Location**, select **Internal**.
<% end %>

<%# For all other IaaSes such as OpenStack, vSphere and manual Azure: %>
<% if current_page.data.iaas != "GCP" && current_page.data.iaas != "AWS" && current_page.data.install_type != "terraform" %>
Select a **Database Location**. By default, <%= vars.ops_manager %> deploys and manages an **Internal** database for you. If you choose to use an **External MySQL Database**, complete the associated fields with information obtained from your external MySQL Database provider: **Host**, **Port**, **Username**, **Password**, and **Database**.
<p class='note'><strong>Note:</strong> Use of an External MySQL Database only applies to the BOSH Director. UAA and CredHub will not use these settings and will continue to use the Postgres database colocated with the BOSH Director.</p>
<p class='note warning'><strong>Warning:</strong> After you deploy the BOSH Director, you cannot change the <b>Database Location</b> from an <b>External MySQL Database</b> to an <b>Internal</b> database or from an <b>Internal</b> database to an <b>External MySQL Database</b>.</p>
    <%= image_tag("../common/images/director_database.png", :alt=> "At the top of the image are the words 'Database Location', underneath which are two options: one selected radio button labeled 'Internal', and one radio button labeled 'External MySQL Database'. Below these are five text fields labeled, from top to bottom, 'Host', 'Port', 'Username', 'Password', and 'Database'. All have red asterisks, to denote that they are required fields when 'External MySQL Database' is selected.") %><br>
    In addition, if you selected the **Enable TLS for Director Database** checkbox, you can complete the following optional fields:
    * **Enable TLS:** Select this checkbox enables TLS communication between the BOSH Director and the database.
    * **TLS CA:** Enter the Certificate Authority for the TLS Certificate.
    * **TLS Certificate:** Enter the client certificate for mutual TLS connections to the database.
    * **TLS Private Key:** Enter the client private key for mutual TLS connections to the database.
    * **Advanced DB Connection Options:** This field accepts a JSON-formatted options string. It should be left blank unless directed by <%= vars.company_name %> Support.

<% end %>
